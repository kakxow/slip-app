# slip-app
Живой экземпляр тут - https://slip-app.herokuapp.com/
## О приложении

Это приложение позволяет собирать, хранить и представлять в веб интерфейсе данные об оплате картами на торговых точках компании.

Использованные технологии и пакеты - python 3.7, Flask (Flask-SQLAlchemy, Flask-Login, Flask-Mail, Flask-Migrate, Flask-WTF), Connexion, SQLAlchemy, SQLite, Poppler.  
Для менеджмента пакетов и зависимостей используется pipenv, но в репозитории есть файл requirements.txt для возможности использования без pipenv.

## Установка
####Для запуска локально
Клонируйте репозиторий, установите необходимые пакеты через pipenv или pip, задайте необходимые переменные окружения (подробнее ниже).  
В терминале из корневой директории проекта выполните ```pipenv run flask run``` для запуска веб-приложения.  
Для запуска парсера ```pipenv run python run_parser.py 8```, где аргумент скрипта - количество потоков для параллельной обработки файлов.

####Для деплоя
dockerfile и procfile для heroku в комплекте.

## Переменные окружения

Уже включён файл .env с именем приложения для flask, pipenv будет испольозвать этот файл его по умолчанию,
для остальных случаев используется python-dotenv.

FLASK_APP - имя приложения, должно быть как в .env - slip_app.py  
SECRET_KEY - установите секретный ключ на свой вкус  
DATABASE_URL - путь к БД с данными, по умолчанию используется бд для презентации по адресу db/example_db.db. 
При старте с новой БД выполните ```pipenv run flask db upgrade```.  
DB_PASSWORD - установите пароль для внесения изменений через API.  
FLASK_ENV - установите "development" при необходимости. По умолчанию "production".

#####Переменные для работы с эл.почтой
Если хотя бы одна из переменных ниже не задана - отправка эл.почты работать не будет.  
MAIL_SERVER  
MAIL_PORT  
MAIL_USE_TLS  
MAIL_USERNAME  
MAIL_PASSWORD  


#####Прочие
POPPLER_PATH - используйте если у вас уже установлены утилиты poppler и вы не хотите пользоваться имеющимися в репозитории.  
SLIP_DIR - корневая директория для поиска файлов слипов, по умолчанию \\Msk-vm-slip\SLIP.  
PAGE_SIZE - используйте для изменения количества выводимых строк на странице.
